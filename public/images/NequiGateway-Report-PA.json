{
  "swagger": "2.0",
  "info": {
    "title": "Servicios de reportes",
    "description": "Servicio para consultar la información de las transacciones.",
    "version": "2020-10-08T10:00:49Z"
  },
  "host": "api.sandbox.nequi.com",
  "basePath": "/partners/v2",
  "schemes": [
    "https"
  ],
  "tags": [
    {
      "name": "Reportes de transacciones",
      "description": "Servicio para consultar la información de las transacciones."
    }
  ],
  "paths": {
    "/-services-reportsservice-getreports": {
      "post": {
        "tags": [
          "Reportes de transacciones"
        ],
        "summary": "Servicio de reportes",
        "description": "Servicio para consultar la información de las transacciones de pagos Nequi asociadas a un cc, ce, nit o ruc de comercio y retorna un reporte con encabezado y una lista de transacciones en formatos JSON, CSV y PDF. A continuación se presenta una guía sobre cómo consumir el API expuesta por NEQUI para obtener estos reportes.",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Objeto de la petición",
            "required": true,
            "schema": {
              "$ref": "#/definitions/reportsRQ"
            }
          },
          {
            "in": "header",
            "name": "Authorization",
            "description": "Token de seguridad generado en formato 'Bearer ${access_token}'",
            "required": true,
            "type": "string"
          },
          {
            "in": "header",
            "name": "x-api-key",
            "description": "Api key obtenido en conecta",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "200 response",
            "schema": {
              "$ref": "#/definitions/reportsRS"
            },
            "headers": {}
          },
          "403": {
            "description": "Access Key, Secret Key o API Key invalidos"
          }
        },
        "security": []
      }
    }
  },
  "securityDefinitions": {
    "api_key": {
      "type": "apiKey",
      "name": "x-api-key",
      "in": "header"
    },
    "OAuth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "x-amazon-apigateway-authtype": "cognito_user_pools"
    }
  },
  "definitions": {
    "reportsRQ": {
      "type": "object",
      "title": "RequestMessage",
      "required": [
        "RequestMessage"
      ],
      "properties": {
        "RequestMessage": {
          "title": "RequestMessage",
          "type": "object",
          "description": "Estructura genérica del mensaje con los encabezados y el cuerpo",
          "required": [
            "RequestHeader",
            "RequestBody"
          ],
          "properties": {
            "RequestHeader": {
              "title": "RequestHeader",
              "type": "object",
              "description": "Contiene los encabezados genéricos de aplicación del mensaje",
              "required": [
                "Channel",
                "RequestDate",
                "MessageID",
                "ClientID",
                "Destination"
              ],
              "properties": {
                "Channel": {
                  "type": "string",
                  "description": "Canal por el que se envia el mensaje",
                  "default": "MF-001"
                },
                "RequestDate": {
                  "type": "string",
                  "description": "Datestamp o Timestamp completo, con milisegundos precisión 3",
                  "default": "2017-06-21T20:26:12.654Z"
                },
                "MessageID": {
                  "description": "Identificador unico de la transacción, alfanumérico de longitud 10, atributo con proposito de trazabilidad",
                  "type": "string",
                  "default": "1234567890"
                },
                "ClientID": {
                  "description": "Terminal, Nodo, Servidor, Contenedor desde donde se lanza la petición, atributo con proposito de trazabilidad",
                  "type": "string",
                  "default": "12345"
                },
                "Destination": {
                  "title": "Destination",
                  "type": "object",
                  "description": "Contiene los atributos que definen la región y versión del servicio",
                  "required": [
                    "ServiceRegion",
                    "ServiceVersion",
                    "ServiceName",
                    "ServiceOperation"
                  ],
                  "properties": {
                    "ServiceName": {
                      "description": "Nombre del servicio",
                      "type": "string",
                      "default": "C001"
                    },
                    "ServiceOperation": {
                      "description": "Operación del servicio",
                      "type": "string",
                      "default": "C001"
                    },
                    "ServiceRegion": {
                      "description": "Región en el cual se debe ejecutar el servicio",
                      "type": "string",
                      "default": "C001"
                    },
                    "ServiceVersion": {
                      "description": "Versión a ejecutar del servicio",
                      "type": "string",
                      "default": "1.0.0"
                    }
                  }
                }
              }
            },
            "RequestBody": {
              "title": "RequestBody",
              "type": "object",
              "description": "Contiene los parametros o cuerpo del servicio a consumir",
              "required": [
                "any"
              ],
              "properties": {
                "any": {
                  "title": "any",
                  "type": "object",
                  "description": "Contiene el elemento con los atributos especificos del servicio a consumir",
                  "required": [
                    "getReportsRQ"
                  ],
                  "properties": {
                    "getReportsRQ": {
                      "title": "getReportsRQ",
                      "type": "object",
                      "description": "Contiene los atributos del servicio de reporte",
                      "required": [
                        "code",
                        "startDate",
                        "endDate",
                        "format"
                      ],
                      "properties": {
                        "code": {
                          "type": "string",
                          "description": "Tipo y número de identificación del comercio o identificador de la terminal, caja o dependencia que va a realizar un reporte",
                          "default": "NIT_901049033"
                        },
                        "startDate": {
                          "type": "string",
                          "description": "Fecha de inicio del reporte ",
                          "default": "2018-09-01"
                        },
                        "endDate": {
                          "type": "string",
                          "description": "fecha fin del reporte",
                          "default": "2018-09-09"
                        },
                        "format": {
                          "type": "string",
                          "format": "string",
                          "description": "Tipo de archivo del reporte",
                          "default": "csv"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "reportsRS": {
      "type": "object",
      "title": "ResponseMessage",
      "required": [
        "ResponseMessage"
      ],
      "properties": {
        "ResponseMessage": {
          "title": "ResponseMessage",
          "type": "object",
          "description": "Estructura genérica de la respuesta con los encabezados y el cuerpo",
          "required": [
            "ResponseHeader",
            "ResponseBody"
          ],
          "properties": {
            "ResponseHeader": {
              "title": "ResponseHeader",
              "type": "object",
              "description": "Contiene los encabezados genéricos de aplicación del mensaje",
              "required": [
                "Channel",
                "ResponseDate",
                "Status",
                "MessageID",
                "ClientID",
                "Destination"
              ],
              "properties": {
                "Channel": {
                  "type": "string",
                  "description": "Canal por el que se envío el mensaje",
                  "default": "MF-001"
                },
                "ResponseDate": {
                  "type": "string",
                  "description": "Datestamp o Timestamp completo, con milisegundos precisión 3",
                  "default": "2017-06-21T20:26:12.654Z"
                },
                "Status": {
                  "title": "Status",
                  "type": "object",
                  "description": "Contiene los atributos que definen el resultado de la operación del servicio",
                  "required": [
                    "StatusCode",
                    "StatusDesc"
                  ],
                  "properties": {
                    "StatusCode": {
                      "description": "Código que indica el resultado del servicio",
                      "type": "string",
                      "default": "0"
                    },
                    "StatusDesc": {
                      "description": "Mensaje sobre el resultado del servicio",
                      "type": "string",
                      "default": "SUCCESS"
                    }
                  }
                },
                "MessageID": {
                  "description": "Retorna el identificador único de la transacción",
                  "type": "string",
                  "default": "1234567890"
                },
                "ClientID": {
                  "description": "Retorna la Terminal, Nodo, Servidor o Contenedor desde donde se lanzo la petición",
                  "type": "string",
                  "default": "12345"
                }
              }
            },
            "ResponseBody": {
              "title": "ResponseBody",
              "type": "object",
              "description": "Contiene el cuerpo con la respuesta del servicio",
              "required": [
                "any"
              ],
              "properties": {
                "any": {
                  "title": "any",
                  "type": "object",
                  "description": "Contiene el elemento con los atributos especificos de la respuesta del servicio",
                  "required": [
                    "getReportsRS"
                  ],
                  "properties": {
                    "getReportsRS": {
                      "title": "getReportsRS",
                      "type": "object",
                      "description": "Contiene los atributos de la respuesta del servicio de reporte",
                      "required": [
                        "commerce",
                        "ruc",
                        "accountNumber",
                        "from",
                        "to",
                        "total",
                        "count",
                        "transactions"
                      ],
                      "properties": {
                        "commerce": {
                          "description": "Nombre del comercio",
                          "type": "string",
                          "default": "NOMBRE COMERCIO"
                        },
                        "ruc": {
                          "description": "Tipo de identificación del comercio",
                          "type": "string",
                          "default": "RUC"
                        },
                        "accountNumber": {
                          "description": "Numero de la cuenta",
                          "type": "string",
                          "default": [
                            "Numero de cuenta"
                          ]
                        },
                        "from": {
                          "description": "Fecha inicio del reporte",
                          "type": "string",
                          "default": "2017-12-31T10:00:00.000Z"
                        },
                        "to": {
                          "description": "Fecha fin del reporte",
                          "type": "string",
                          "default": "2018-09-09T09:59:59.000Z"
                        },
                        "total": {
                          "description": "Cantidad de dinero del perido de tiempo",
                          "type": "string",
                          "format": "number",
                          "default": "119.59999999999997"
                        },
                        "count": {
                          "description": "Cantidad de transacciones creadas en el periodo de tiempo ",
                          "type": "string",
                          "format": "number",
                          "default": "25"
                        },
                        "transactions": {
                          "type": "array",
                          "description": "Arrays con las transacciones creadas en el periodo de tiempo",
                          "items": {
                            "type": "object",
                            "title": "transactions",
                            "description": "Atributos que describen el origen y la info de la transacción",
                            "properties": {
                              "buyerLastName": {
                                "description": "Apellido del comprador ",
                                "type": "string",
                                "default": "APELLIDO"
                              },
                              "transactionDate": {
                                "description": "Fecha en la que se realizo la transacción ",
                                "type": "string",
                                "default": "2018-08-01 09:15:42"
                              },
                              "commerceName": {
                                "description": "Nombre del comercion",
                                "type": "string",
                                "default": "APELLIDO"
                              },
                              "buyerName": {
                                "description": "Nombre del comprador",
                                "type": "string",
                                "default": "NOMBRE"
                              },
                              "productChannel": {
                                "description": "Canal del producto por el que se envío el mensaje ",
                                "type": "string",
                                "default": "PRODUCTO CANAL"
                              },
                              "transactionReference": {
                                "description": "Referencia de la transaccion creada",
                                "type": "string",
                                "default": "REFERENCIA"
                              },
                              "messageId": {
                                "description": "Retorna el identificador único de la transacción ",
                                "type": "string",
                                "default": "MESSAGEID"
                              },
                              "transactionValue": {
                                "description": "Valor de la transacción ",
                                "type": "string",
                                "format": "number",
                                "default": "0.9"
                              },
                              "transactionTax": {
                                "description": "Impuestos de la transacción ",
                                "type": "number",
                                "default": 6
                              },
                              "transactionTip": {
                                "description": "Propina de la transacción ",
                                "type": "number",
                                "default": 0
                              } 
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}